<!DOCTYPE html>
<html>
<head>
    <title>Ball & Black Hole Game</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        .container {
            text-align: center;
        }

        h1 {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <button id="resetBtn">Reset</button>
        <button id="newMapBtn">New Map</button>
        <h1>Ball & Black Hole Game</h1>
        <canvas id='gameCanvas' width='800' height='600' style='border: 1px solid black; background: white;'></canvas>
        <p>Click to place a black hole and guide the ball to the cyan goal!</p>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        document.getElementById('resetBtn').addEventListener('click', resetGame);
        document.getElementById('newMapBtn').addEventListener('click', newMap);

        let direction;
        let goalLoc;
        let walls;
        let ballX;
        let ballY;
        let velocityX;
        let velocityY;
        let goalX;
        let goalY;
        let blackHoleX;
        let blackHoleY;

        function initializeMap() {
            // Random direction
            direction = Math.floor(Math.random() * 2);

            // Random goal corner
            goalLoc = Math.floor(Math.random() * 4);
            if (goalLoc === 0) {
                goalX = 0;
                goalY = 0;
            } else if (goalLoc === 1) {
                goalX = 700;
                goalY = 0;
            } else if (goalLoc === 2) {
                goalX = 0;
                goalY = 500;
            } else {
                goalX = 700;
                goalY = 500;
            }

            // Generate walls
            walls = [];
            for (let i = 0; i < 5; i++) {
                let wallType = Math.floor(Math.random() * 2);
                let wallX, wallY, wallSizeX, wallSizeY;

                if (wallType === 0) {
                    wallSizeX = 90;
                    wallSizeY = 10;
                } else {
                    wallSizeX = 10;
                    wallSizeY = 90;
                }

                if (direction === 0) {
                    do {
                        wallX = 100 * Math.floor(Math.random() * 7);
                        wallY = 100 * Math.floor(Math.random() * 5);
                    } while (wallY === 300);
                } else {
                    do {
                        wallX = 100 * Math.floor(Math.random() * 7);
                        wallY = 100 * Math.floor(Math.random() * 5);
                    } while (wallX === 300);
                }

                walls.push({ x: wallX, y: wallY, width: wallSizeX, height: wallSizeY });
            }
        }

        function resetGame() {
            // Reset ball position
            ballX = 300;
            ballY = 300;

            // Reset velocities based on current direction
            if (direction === 0) {
                velocityX = 2;
                velocityY = 0;
            } else {
                velocityX = 0;
                velocityY = 2;
            }

            // Clear black hole
            blackHoleX = null;
            blackHoleY = null;

            // Restart animation
            animate();
        }

        function newMap() {
            initializeMap();
            resetGame();
        }


        // Ball properties
        let ballRadius = 10;


        // Black hole properties
        let blackHoleRadius = 20;

        // Goal properties
        let goalSize = 40;

        // Click handler to place black hole
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            blackHoleX = e.clientX - rect.left;
            blackHoleY = e.clientY - rect.top;
        });

        // Draw everything
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw black hole if placed
            if (blackHoleX !== null) {
                ctx.beginPath();
                ctx.arc(blackHoleX, blackHoleY, blackHoleRadius, 0, Math.PI * 2);
                ctx.fillStyle = 'black';
                ctx.fill();
                ctx.closePath();
            }

            // Draw ball
            ctx.beginPath();
            ctx.arc(ballX, ballY, ballRadius, 0, Math.PI * 2);
            ctx.fillStyle = 'blue';
            ctx.fill();
            ctx.closePath();

            // Draw goal
            ctx.fillStyle = 'cyan';
            ctx.fillRect(goalX, goalY, goalSize, goalSize);

            // Draw wall
            ctx.fillStyle = 'red';
            for (let i = 0; i < 5; i++) {
                ctx.fillRect(walls[i].x, walls[i].y, walls[i].width, walls[i].height);
            }
        }

        // Animation loop
        function animate() {
            // Apply gravity if black hole exists
            if (blackHoleX !== null) {
                let dx = blackHoleX - ballX;
                let dy = blackHoleY - ballY;
                let distance = Math.sqrt(dx * dx + dy * dy);

                if (distance > 1) {
                    let force = 1000 / (distance * distance);
                    velocityX += force * (dx / distance);
                    velocityY += force * (dy / distance);
                }
            }

            // Cap maximum velocity
            let speed = Math.sqrt(velocityX * velocityX + velocityY * velocityY);
            let maxSpeed = 20;
            if (speed > maxSpeed) {
                velocityX = (velocityX / speed) * maxSpeed;
                velocityY = (velocityY / speed) * maxSpeed;
            }

            ballX += velocityX;
            ballY += velocityY;

            // Bounce off walls
            if (ballX + ballRadius > canvas.width || ballX - ballRadius < 0) velocityX *= -1;
            if (ballY + ballRadius > canvas.height || ballY - ballRadius < 0) velocityY *= -1;

            // Check if ball reached the goal
            if (ballX > goalX && ballX < goalX + goalSize &&
                ballY > goalY && ballY < goalY + goalSize) {
                ctx.fillStyle = 'green';
                ctx.font = '48px Arial';
                ctx.fillText('You Win!', canvas.width/2 - 100, canvas.height/2);
                return;
            }

            // Check if ball hits the wall
            for (let i = 0; i < 5; i++) {
                if (ballX + ballRadius > walls[i].x && ballX - ballRadius < walls[i].x + walls[i].width &&
                    ballY + ballRadius > walls[i].y && ballY - ballRadius < walls[i].y + walls[i].height) {
                    ctx.fillStyle = 'red';
                    ctx.font = '48px Arial';
                    ctx.fillText('You Lose!', canvas.width / 2 - 100, canvas.height / 2);
                    return;
                }
            }
            draw();
            requestAnimationFrame(animate);
        }

        // Call initializeMap and resetGame
        initializeMap();
        resetGame();

    </script>
</body>
</html>
